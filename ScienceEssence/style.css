/* ===== RESET ===== */
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

html, body {
    width: 100%; height: 100%;
    overflow: hidden;
    font-family: 'EB Garamond', serif;
    background: #12100a;
}

/* ===== SCENE ===== */
.scene {
    position: relative;
    width: 100%; height: 100vh;
    overflow: hidden;
    background: #14110b;
}

/* ===== LIBRARY ===== */
.library {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 62%;
    z-index: 1;
    overflow: hidden;
}

.library-shelves {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
}

/* Each shelf row will be generated by JS */
.shelf-row {
    flex: 1;
    display: flex;
    align-items: flex-end;
    border-bottom: 8px solid #2E1C0A;
    padding: 0 2px;
    box-shadow: 0 3px 4px rgba(0,0,0,0.5);
    background: linear-gradient(180deg, #3a3028 0%, #2E2418 85%, #3D2810 95%, #2E1C0A 100%);
}

.bg-book {
    flex-shrink: 0;
    border-radius: 1px 2px 2px 1px;
    box-shadow: inset -1px 0 2px rgba(0,0,0,0.3), inset 1px 0 1px rgba(255,255,255,0.06);
}

/* Dimmer over library */
.library-dimmer {
    position: absolute;
    inset: 0;
    background: linear-gradient(
        180deg,
        rgba(5,3,2,0.35) 0%,
        rgba(5,3,2,0.25) 30%,
        rgba(5,3,2,0.3) 70%,
        rgba(5,3,2,0.5) 100%
    );
    z-index: 2;
}

/* ===== DESK ===== */
.desk {
    position: absolute;
    bottom: 0; left: 0;
    width: 100%; height: 38%;
    z-index: 3;
    background: linear-gradient(
        180deg,
        #2a1e10 0%,
        #2E1C0A 15%,
        #241608 50%,
        #1a1008 100%
    );
}

.desk-edge-strip {
    display: none;
}

/* ===== LAMP LIGHT ===== */
.lamp-light {
    position: absolute;
    inset: 0;
    background: radial-gradient(
        ellipse 45% 55% at 50% 55%,
        rgba(255,190,90,0.09) 0%,
        rgba(255,150,50,0.04) 30%,
        transparent 60%
    );
    z-index: 4;
    pointer-events: none;
}

/* ===== LAMP ===== */
.lamp {
    position: absolute;
    bottom: 37%; right: 18%;
    z-index: 15;
}

.lamp-svg { display: block; }

.flame-wrap {
    position: absolute;
    top: 16px; left: 36px;
    width: 18px; height: 30px;
}

.flame {
    width: 12px; height: 24px;
    margin: 0 auto;
    background: radial-gradient(ellipse 50% 80% at 50% 90%, #FFF8E0 0%, #FFD54F 25%, #FF9800 55%, #E65100 80%, transparent 100%);
    border-radius: 50% 50% 50% 50% / 70% 70% 30% 30%;
    animation: flame 0.13s ease-in-out infinite alternate;
    position: relative;
}

.flame-core {
    position: absolute;
    bottom: 2px; left: 50%;
    transform: translateX(-50%);
    width: 5px; height: 12px;
    background: radial-gradient(ellipse at 50% 90%, #fff 0%, #FFF9C4 50%, #FFD54F 100%);
    border-radius: 50% 50% 50% 50% / 70% 70% 30% 30%;
    animation: flameCore 0.11s ease-in-out infinite alternate;
}

@keyframes flame {
    0%   { transform: scaleX(1) scaleY(1) rotate(-1deg); }
    33%  { transform: scaleX(0.9) scaleY(1.05) rotate(0.5deg); }
    66%  { transform: scaleX(1.06) scaleY(0.95) rotate(-0.5deg); }
    100% { transform: scaleX(0.94) scaleY(1.03) rotate(1deg); }
}

@keyframes flameCore {
    0%   { transform: translateX(-50%) scaleX(1) scaleY(1); }
    100% { transform: translateX(-50%) scaleX(0.8) scaleY(1.1); }
}

.light-cone {
    position: absolute;
    top: 40px; left: -100px;
    width: 300px; height: 350px;
    background: radial-gradient(ellipse 50% 55% at 55% 0%, rgba(255,200,100,0.07) 0%, rgba(255,170,70,0.02) 45%, transparent 70%);
    pointer-events: none;
}

/* ============================================
   ===== 3D BOOK =====
   ============================================ */
.book-scene {
    position: absolute;
    bottom: 33%;
    left: 50%;
    transform: translateX(-55%);
    z-index: 10;
    perspective: 800px;
}

.book-link {
    display: block;
    text-decoration: none;
    cursor: pointer;
}

.book {
    width: 320px;
    height: 220px;
    position: relative;
    transform-style: preserve-3d;
    transform: rotateX(55deg) rotateZ(-8deg);
    transition: transform 0.6s ease;
    animation: bookFloat 5s ease-in-out infinite;
}

@keyframes bookFloat {
    0%, 100% { transform: rotateX(55deg) rotateZ(-8deg) translateY(0); }
    50% { transform: rotateX(55deg) rotateZ(-8deg) translateY(-6px); }
}

.book-link:hover .book {
    transform: rotateX(55deg) rotateZ(-8deg) translateY(-8px);
}

.book-face {
    position: absolute;
    backface-visibility: hidden;
}

/* --- TOP COVER --- */
.book-cover {
    width: 320px; height: 220px;
    background: linear-gradient(135deg, #5A2D0C 0%, #4A2308 30%, #3D1C06 70%, #2E1504 100%);
    border: 1.5px solid #1A0A02;
    border-radius: 2px 4px 4px 2px;
    transform: translateZ(50px);
    overflow: hidden;
}

.leather-texture {
    position: absolute; inset: 0;
    background-image:
        radial-gradient(circle at 20% 30%, rgba(80,40,15,0.15) 0%, transparent 40%),
        radial-gradient(circle at 70% 60%, rgba(90,50,20,0.1) 0%, transparent 35%),
        radial-gradient(circle at 50% 80%, rgba(70,35,10,0.12) 0%, transparent 30%);
    opacity: 0.6;
}

.cover-glow {
    position: absolute; inset: 0;
    background: radial-gradient(ellipse 65% 55% at 50% 45%, rgba(255,220,120,0.18) 0%, rgba(218,165,32,0.06) 40%, transparent 65%);
    animation: coverGlow 3s ease-in-out infinite;
    pointer-events: none;
}

@keyframes coverGlow {
    0%, 100% { opacity: 0.6; }
    50% { opacity: 1; }
}

/* Gold border */
.cover-border {
    position: absolute;
    top: 12px; left: 12px; right: 12px; bottom: 12px;
    border: 2px solid rgba(218,175,40,0.55);
    border-radius: 2px;
    box-shadow: 0 0 8px rgba(218,165,32,0.1), inset 0 0 8px rgba(218,165,32,0.05);
}

.cover-border-inner {
    position: absolute;
    top: 6px; left: 6px; right: 6px; bottom: 6px;
    border: 1px solid rgba(218,175,40,0.35);
    border-radius: 1px;
}

/* Corner filigree */
.corner-fl {
    position: absolute;
    width: 18px; height: 18px;
    border-color: rgba(212,160,23,0.4);
    border-style: solid;
    border-width: 0;
}
.corner-fl::after {
    content: '';
    position: absolute;
    width: 6px; height: 6px;
    border-radius: 50%;
    background: rgba(212,160,23,0.25);
}
.corner-tl { top: -2px; left: -2px; border-top-width: 1.5px; border-left-width: 1.5px; }
.corner-tl::after { top: 3px; left: 3px; }
.corner-tr { top: -2px; right: -2px; border-top-width: 1.5px; border-right-width: 1.5px; }
.corner-tr::after { top: 3px; right: 3px; }
.corner-bl { bottom: -2px; left: -2px; border-bottom-width: 1.5px; border-left-width: 1.5px; }
.corner-bl::after { bottom: 3px; left: 3px; }
.corner-br { bottom: -2px; right: -2px; border-bottom-width: 1.5px; border-right-width: 1.5px; }
.corner-br::after { bottom: 3px; right: 3px; }

/* --- TITLE --- */
.book-title {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 2px;
    padding: 10px;
}

.title-line {
    display: block;
    font-family: 'Cinzel Decorative', serif;
    color: #D4A017;
    text-align: center;
    text-shadow:
        0 0 10px rgba(218,165,32,0.6),
        0 0 25px rgba(218,165,32,0.3),
        0 0 50px rgba(218,165,32,0.15);
    animation: titleGlow 3s ease-in-out infinite;
}

.line-1 { font-size: 22px; font-weight: 700; animation-delay: 0s; }
.line-2 { font-size: 14px; font-weight: 400; opacity: 0.8; animation-delay: 0.2s; }
.line-3 { font-size: 28px; font-weight: 900; letter-spacing: 0.08em; animation-delay: 0.4s; }
.line-4 {
    font-size: 11px; font-weight: 400;
    font-family: 'EB Garamond', serif;
    font-style: italic;
    opacity: 0.5;
    text-shadow: 0 0 8px rgba(218,165,32,0.3);
    animation: none;
    margin-top: 4px;
}

.title-divider {
    width: 80px; height: 1px;
    background: linear-gradient(90deg, transparent, rgba(212,160,23,0.5), transparent);
    margin: 4px 0;
}

.title-ornament {
    color: rgba(212,160,23,0.35);
    font-size: 14px;
    line-height: 1;
}
.top-ornament { margin-bottom: 4px; }
.bottom-ornament { margin-top: 2px; }

@keyframes titleGlow {
    0%, 100% {
        text-shadow: 0 0 10px rgba(218,165,32,0.5), 0 0 25px rgba(218,165,32,0.25), 0 0 50px rgba(218,165,32,0.1);
        color: #D4A020;
    }
    50% {
        text-shadow: 0 0 18px rgba(255,210,80,0.9), 0 0 40px rgba(218,165,32,0.5), 0 0 70px rgba(218,165,32,0.25), 0 0 100px rgba(218,165,32,0.1);
        color: #F0D060;
    }
}

/* Hover intensify */
.book-link:hover .title-line {
    text-shadow:
        0 0 20px rgba(255,220,80,1),
        0 0 50px rgba(218,165,32,0.6),
        0 0 90px rgba(218,165,32,0.3),
        0 0 130px rgba(218,165,32,0.12);
    color: #FFF0A0;
}

.book-link:hover .cover-glow {
    opacity: 1;
    background: radial-gradient(ellipse 70% 60% at 50% 45%, rgba(255,220,120,0.28) 0%, rgba(218,165,32,0.08) 40%, transparent 65%);
}

/* --- FRONT EDGE --- */
.book-front {
    display: none;
}

/* --- RIGHT EDGE (pages) --- */
.book-right {
    width: 50px; height: 220px;
    background: linear-gradient(90deg, #E8DCC0 0%, #DDD0B0 30%, #D0C4A0 70%, #C8BA98 100%);
    transform: rotateY(90deg) translateZ(320px);
    transform-origin: left;
    border-right: 1px solid #B8A880;
}

/* Page line texture */
.page-lines {
    position: absolute; inset: 0;
    background: repeating-linear-gradient(
        0deg,
        transparent 0px,
        transparent 1.2px,
        rgba(180,160,120,0.18) 1.2px,
        rgba(180,160,120,0.18) 1.6px
    );
}

.book-right .page-lines {
    background: repeating-linear-gradient(
        90deg,
        transparent 0px,
        transparent 1.2px,
        rgba(180,160,120,0.18) 1.2px,
        rgba(180,160,120,0.18) 1.6px
    );
}

/* --- BOTTOM --- */
.book-bottom {
    width: 320px; height: 220px;
    background: #2E1504;
    transform: translateZ(0px);
}

/* --- SPINE --- */
.book-spine {
    display: none;
}

.spine-band {
    display: none;
}

/* --- BACK EDGE --- */
.book-back {
    display: none;
}

/* Book shadow on desk */
.book-desk-shadow {
    position: absolute;
    bottom: -20px; left: 5%;
    width: 90%; height: 30px;
    background: radial-gradient(ellipse, rgba(0,0,0,0.5) 0%, transparent 70%);
    filter: blur(12px);
    z-index: -1;
}

/* Title glow halo under the book */
.title-glow-halo {
    position: absolute;
    top: -80px; left: -80px; right: -80px; bottom: -80px;
    background:
        radial-gradient(ellipse 45% 40% at 50% 50%, rgba(218,165,32,0.14) 0%, transparent 60%),
        radial-gradient(ellipse 60% 55% at 50% 50%, rgba(255,200,80,0.06) 0%, transparent 70%);
    animation: haloBreath 4s ease-in-out infinite;
    pointer-events: none;
    z-index: -1;
}

/* Divine light rays behind book */
.title-glow-halo::before {
    content: '';
    position: absolute;
    inset: -40px;
    background:
        conic-gradient(
            from 0deg at 50% 50%,
            transparent 0deg,
            rgba(218,165,32,0.04) 15deg,
            transparent 30deg,
            rgba(218,165,32,0.03) 50deg,
            transparent 65deg,
            rgba(218,165,32,0.05) 85deg,
            transparent 100deg,
            rgba(218,165,32,0.03) 120deg,
            transparent 140deg,
            rgba(218,165,32,0.04) 165deg,
            transparent 180deg,
            rgba(218,165,32,0.04) 200deg,
            transparent 220deg,
            rgba(218,165,32,0.03) 245deg,
            transparent 265deg,
            rgba(218,165,32,0.05) 290deg,
            transparent 310deg,
            rgba(218,165,32,0.03) 340deg,
            transparent 360deg
        );
    animation: raysRotate 30s linear infinite;
    border-radius: 50%;
}

@keyframes haloBreath {
    0%, 100% { opacity: 0.5; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.12); }
}

@keyframes raysRotate {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

/* ===== DESK ITEMS ===== */
.desk-items {
    position: absolute;
    bottom: 0; left: 0;
    width: 100%; height: 45%;
    z-index: 9;
    pointer-events: none;
}

.writing-set {
    position: absolute;
    bottom: 37%; left: 18%;
    opacity: 0.6;
}

.parchment {
    position: absolute;
    bottom: 37%; left: 5%;
    opacity: 0.55;
    transform: rotate(-2deg);
}

/* Newton's Cradle */
.newtons-cradle {
    position: absolute;
    bottom: 30%; left: 62%;
    width: 140px; height: 120px;
    opacity: 0.55;
}

.cradle-frame {
    position: absolute;
    top: 0; left: 0;
}

.cradle-balls {
    position: absolute;
    top: 20px; left: 30px;
    display: flex;
    gap: 0px;
    align-items: flex-start;
}

.cradle-string-ball {
    width: 16px;
    display: flex;
    flex-direction: column;
    align-items: center;
    transform-origin: top center;
}

.cradle-string {
    width: 1px; height: 62px;
    background: rgba(180,160,120,0.4);
}

.cradle-ball {
    width: 14px; height: 14px;
    border-radius: 50%;
    background: radial-gradient(circle at 35% 35%, #C0B090, #8B7A60 50%, #5A4A30 100%);
    box-shadow: 0 1px 3px rgba(0,0,0,0.4), inset 0 1px 2px rgba(255,255,255,0.1);
}

/* Left ball swings out then rests when right swings */
.ball-left {
    animation: swingLeft 1.6s ease-in-out infinite;
}

/* Right ball swings out then rests when left swings */
.ball-right {
    animation: swingRight 1.6s ease-in-out infinite;
}

@keyframes swingLeft {
    0%   { transform: rotate(0deg); }
    50%  { transform: rotate(0deg); }
    75%  { transform: rotate(30deg); }
    100% { transform: rotate(0deg); }
}

@keyframes swingRight {
    0%   { transform: rotate(0deg); }
    25%  { transform: rotate(-30deg); }
    50%  { transform: rotate(0deg); }
    100% { transform: rotate(0deg); }
}

/* Physics desk objects */
.desk-object {
    position: absolute;
    pointer-events: none;
}

.magnifying-glass {
    bottom: 28%; right: 12%;
    opacity: 0.45;
    transform: rotate(25deg);
}

.hourglass {
    bottom: 30%; right: 35%;
    opacity: 0.4;
}

.prism {
    bottom: 26%; left: 35%;
    opacity: 0.4;
    transform: rotate(-8deg);
}

.compass-tool {
    bottom: 18%; right: 20%;
    opacity: 0.38;
    transform: rotate(12deg);
}

.pocket-watch {
    bottom: 24%; left: 25%;
    opacity: 0.4;
    transform: rotate(-15deg);
}

/* ===== PARTICLES ===== */
.particles {
    position: absolute;
    inset: 0;
    z-index: 16;
    pointer-events: none;
    overflow: hidden;
}

/* ===== VIGNETTE ===== */
.vignette {
    position: absolute; inset: 0;
    background: radial-gradient(
        ellipse 50% 45% at 48% 48%,
        transparent 0%,
        rgba(5,3,2,0.3) 40%,
        rgba(5,3,2,0.7) 70%,
        rgba(5,3,2,0.92) 100%
    );
    z-index: 17;
    pointer-events: none;
}

/* ===== CURSOR LIGHT (lantern reveal) ===== */
.cursor-light {
    position: fixed;
    width: 500px;
    height: 500px;
    border-radius: 50%;
    background: radial-gradient(circle,
        rgba(255,200,120,0.18) 0%,
        rgba(255,180,100,0.1) 15%,
        rgba(255,160,80,0.04) 35%,
        transparent 55%
    );
    pointer-events: none;
    z-index: 17;
    transform: translate(-50%, -50%);
    transition: opacity 0.4s ease;
    opacity: 0;
    mix-blend-mode: screen;
}

/* ===== CURSOR GLOW ===== */
.cursor-glow {
    position: fixed;
    width: 250px;
    height: 250px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(218,165,32,0.08) 0%, rgba(255,200,100,0.03) 30%, transparent 60%);
    pointer-events: none;
    z-index: 18;
    transform: translate(-50%, -50%);
    transition: opacity 0.3s ease;
    opacity: 0;
}

/* ===== ENTER HINT ===== */
.enter-hint {
    position: absolute;
    bottom: 7%; left: 50%;
    transform: translateX(-50%);
    z-index: 20;
    opacity: 0;
    animation: fadeUp 2s ease forwards 2.5s;
}

.enter-hint p {
    font-family: 'EB Garamond', serif;
    font-style: italic;
    font-size: clamp(0.9rem, 1.8vw, 1.3rem);
    color: rgba(200,170,110,0.45);
    letter-spacing: 0.12em;
    animation: hintPulse 3.5s ease-in-out infinite;
}

@keyframes hintPulse {
    0%, 100% { opacity: 0.3; }
    50% { opacity: 0.7; text-shadow: 0 0 15px rgba(218,165,32,0.15); }
}

@keyframes fadeUp {
    from { opacity: 0; transform: translateX(-50%) translateY(12px); }
    to   { opacity: 1; transform: translateX(-50%) translateY(0); }
}

/* ===== RESPONSIVE ===== */
@media (max-width: 768px) {
    .book { transform: rotateX(55deg) rotateZ(-8deg) scale(0.7); animation: none; }
    .lamp { right: 8%; transform: scale(0.75); transform-origin: bottom right; }
}

@media (max-width: 480px) {
    .book { transform: rotateX(55deg) rotateZ(-8deg) scale(0.5); }
    .lamp { right: 4%; transform: scale(0.6); }
}
